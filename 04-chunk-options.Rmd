---
title: "Reproducible Research with RMarkdown"
author: "Stephen D. Turner, Ph.D."
date: "August 16, 2023"
output: html_document
---

```{r, echo=FALSE}
# Document-wide options
library(knitr)
opts_chunk$set(message=FALSE)
```

# RMarkdown

## How it works

An RMarkdown document looks like any other markdown document with two additions. 

1. The YAML front matter. The only mandatory field is the `output:` tag. Here we're using HTML, but we'll look at other output formats later. Other tags are optional, but fields like `title`, `author`, and `date` can be used to create document headings as well as metadata into the output document.
2. R code chunks. 

Authoring documents with RMarkdown starts with a `.Rmd` file that contains a combination of markdown and R code chunks. The .Rmd file is fed to knitr, which executes all of the R code chunks and creates a new temporary plain markdown (.md) document which includes the R code and the output that code produced. The markdown file generated by knitr is then rendered into a web page (HTML), PDF, MS Word document, and other output formats. This is all done with a single render function, or by clicking the "Knit" button in RStudio (CMD-Shift-K).

![RMarkdown flow. Details will be covered in the following sections.](img/rmarkdownflow.png)

## Demonstration

This is an R code chunk. The code written here will be evaluated, and the result will be injected back into a transient markdown file, which will be rendered into the output format specified in the header.

```{r}
head(iris)
ncol(iris)
nrow(iris)
```

You can also evaluate an R expression _inline_ like this:

- There are `r nrow(iris)` observations in this dataset.
- The maximum petal length is `r max(iris$Petal.Length)`.

We could start to do some data analysis here. Let's do some basic summary analysis with dplyr, getting the mean of all the variables by species:

```{r, echo=FALSE}
library(dplyr)
iris |> 
  group_by(Species) |> 
  summarize(across(everything(), mean))
```

We can also create plots:

```{r}
library(ggplot2)
p <- 
  ggplot(iris, aes(Petal.Width, Petal.Length, col=Species)) + 
  geom_point() + 
  theme_bw()
p
```

We can also make this plot interactive!

```{r}
library(plotly)
ggplotly(p)
```
